2024-05-27 19:08:14.711 | WARNING  | qlib.tests.data:qlib_data:175 - Data already exists: ~/.qlib/qlib_data/cn_data, the data download will be skipped
	If downloading is required: `exists_skip=False` or `change target_dir`
[8269:MainThread](2024-05-27 19:08:14,711) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[8269:MainThread](2024-05-27 19:08:14,712) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[8269:MainThread](2024-05-27 19:08:14,713) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/Users/boss/.qlib/qlib_data/cn_data')}
[8269:MainThread](2024-05-27 19:08:21,139) INFO - qlib.timer - [log.py:127] - Time cost: 5.621s | Loading data Done
/Users/boss/qlib/.venv/lib/python3.9/site-packages/numpy/lib/nanfunctions.py:1095: RuntimeWarning:

All-NaN slice encountered

[8269:MainThread](2024-05-27 19:08:23,343) INFO - qlib.timer - [log.py:127] - Time cost: 2.187s | RobustZScoreNorm Done
[8269:MainThread](2024-05-27 19:08:23,459) INFO - qlib.timer - [log.py:127] - Time cost: 0.116s | Fillna Done
[8269:MainThread](2024-05-27 19:08:23,460) INFO - qlib.timer - [log.py:127] - Time cost: 2.320s | fit & process data Done
[8269:MainThread](2024-05-27 19:08:23,460) INFO - qlib.timer - [log.py:127] - Time cost: 7.942s | Init data Done
------------------------
seed: 130
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
[8269:MainThread](2024-05-27 19:08:23,562) INFO - qlib.MASTER - [pytorch_master_ts.py:255] - MASTER pytorch version...
[8269:MainThread](2024-05-27 19:08:23,907) INFO - qlib.MASTER - [pytorch_master_ts.py:297] - MASTER parameters setting:
 d_feat : 158
 d_model : 256
 t_nhead : 4
 s_nhead : 2
 n_epochs : 40
 lr : 8e-06
 beta : None
 train_stop_loss_thred : 0.95
 visible_GPU : 0
 seed : 130
[8269:MainThread](2024-05-27 19:08:23,908) INFO - qlib.MASTER - [pytorch_master_ts.py:322] - model:
MASTER(
  (feature_gate): Gate(
    (trans): Linear(in_features=63, out_features=158, bias=True)
  )
  (x2y): Linear(in_features=158, out_features=256, bias=True)
  (pe): PositionalEncoding()
  (tatten): TAttention(
    (qtrans): Linear(in_features=256, out_features=256, bias=False)
    (ktrans): Linear(in_features=256, out_features=256, bias=False)
    (vtrans): Linear(in_features=256, out_features=256, bias=False)
    (attn_dropout): ModuleList(
      (0-3): 4 x Dropout(p=0.5, inplace=False)
    )
    (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (ffn): Sequential(
      (0): Linear(in_features=256, out_features=256, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
      (3): Linear(in_features=256, out_features=256, bias=True)
      (4): Dropout(p=0.5, inplace=False)
    )
  )
  (satten): SAttention(
    (qtrans): Linear(in_features=256, out_features=256, bias=False)
    (ktrans): Linear(in_features=256, out_features=256, bias=False)
    (vtrans): Linear(in_features=256, out_features=256, bias=False)
    (attn_dropout): ModuleList(
      (0-1): 2 x Dropout(p=0.5, inplace=False)
    )
    (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (ffn): Sequential(
      (0): Linear(in_features=256, out_features=256, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
      (3): Linear(in_features=256, out_features=256, bias=True)
      (4): Dropout(p=0.5, inplace=False)
    )
  )
  (temporalatten): TemporalAttention(
    (trans): Linear(in_features=256, out_features=256, bias=False)
  )
  (decoder): Linear(in_features=256, out_features=1, bias=True)
)
[8269:MainThread](2024-05-27 19:08:23,908) INFO - qlib.MASTER - [pytorch_master_ts.py:323] - model size: 0.7391 MB
/Users/boss/qlib/.venv/lib/python3.9/site-packages/qlib/contrib/model/pytorch_master_ts.py:231: FutureWarning:

The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.

Epoch 0, train_loss nan, valid_loss nan 
Epoch 1, train_loss nan, valid_loss nan 
Epoch 2, train_loss nan, valid_loss nan 
/Users/boss/qlib/.venv/lib/python3.9/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 1 leaked folder objects to clean up at shutdown
  warnings.warn(
/Users/boss/qlib/.venv/lib/python3.9/site-packages/joblib/externals/loky/backend/resource_tracker.py:330: UserWarning: resource_tracker: /var/folders/yv/x50j6mx12h79c4bkhwvbt18c0000gn/T/joblib_memmapping_folder_8269_243b89bfbe914416a0fbd7a3531d6720_c4d8be8ac6a84385897a188db02950bd: FileNotFoundError(2, 'No such file or directory')
  warnings.warn(f"resource_tracker: {name}: {e!r}")
